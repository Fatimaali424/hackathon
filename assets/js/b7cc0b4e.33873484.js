"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[6007],{179(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>m,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"module-1/lab-3-multi-node","title":"Lab 3: Multi-node System Integration","description":"Overview","source":"@site/docs/module-1/lab-3-multi-node.md","sourceDirName":"module-1","slug":"/module-1/lab-3-multi-node","permalink":"/hackathon/docs/module-1/lab-3-multi-node","draft":false,"unlisted":false,"editUrl":"https://github.com/Fatimaali424/hackathon/edit/main/website/docs/module-1/lab-3-multi-node.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Lab 2: Service and Action Implementation","permalink":"/hackathon/docs/module-1/lab-2-services-actions"},"next":{"title":"Module 1 Assignment: ROS 2 Fundamentals and System Integration","permalink":"/hackathon/docs/module-1/assignment"}}');var i=s(4848),o=s(8453);const a={sidebar_position:7},r="Lab 3: Multi-node System Integration",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Lab Setup",id:"lab-setup",level:2},{value:"System Architecture",id:"system-architecture",level:2},{value:"Service Definition",id:"service-definition",level:3},{value:"Coordinator Node Implementation",id:"coordinator-node-implementation",level:3},{value:"Navigator Node Implementation",id:"navigator-node-implementation",level:3},{value:"Perceptor Node Implementation",id:"perceptor-node-implementation",level:3},{value:"Setup for Execution",id:"setup-for-execution",level:3},{value:"Running the Multi-Node System",id:"running-the-multi-node-system",level:2},{value:"1. Build the Package",id:"1-build-the-package",level:3},{value:"2. Run the Nodes",id:"2-run-the-nodes",level:3},{value:"3. Monitor the System",id:"3-monitor-the-system",level:3},{value:"Multi-Node Communication Patterns",id:"multi-node-communication-patterns",level:2},{value:"Publisher-Subscriber Pattern Across Nodes",id:"publisher-subscriber-pattern-across-nodes",level:3},{value:"Service-Based Communication",id:"service-based-communication",level:3},{value:"Action-Based Communication",id:"action-based-communication",level:3},{value:"Lab Exercises",id:"lab-exercises",level:2},{value:"Exercise 1: Add Error Handling",id:"exercise-1-add-error-handling",level:3},{value:"Exercise 2: Extend the System",id:"exercise-2-extend-the-system",level:3},{value:"Exercise 3: Add Logging and Diagnostics",id:"exercise-3-add-logging-and-diagnostics",level:3},{value:"Exercise 4: Performance Optimization",id:"exercise-4-performance-optimization",level:3},{value:"Debugging Multi-Node Systems",id:"debugging-multi-node-systems",level:2},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:3},{value:"Debugging Commands",id:"debugging-commands",level:3},{value:"Summary",id:"summary",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"lab-3-multi-node-system-integration",children:"Lab 3: Multi-node System Integration"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"In this lab, you will implement a complex multi-node ROS 2 system that demonstrates how different nodes work together to achieve sophisticated robotic behaviors. This lab integrates concepts from previous labs (publishers/subscribers, services, and actions) into a coordinated system that simulates a simple robot performing navigation and manipulation tasks."}),"\n",(0,i.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsx)(n.p,{children:"After completing this lab, you will be able to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Design and implement a multi-node ROS 2 system"}),"\n",(0,i.jsx)(n.li,{children:"Coordinate communication between multiple nodes"}),"\n",(0,i.jsx)(n.li,{children:"Handle complex task execution using services and actions"}),"\n",(0,i.jsx)(n.li,{children:"Debug multi-node system interactions"}),"\n",(0,i.jsx)(n.li,{children:"Implement system-level error handling and recovery"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Completion of Lab 1 (Publisher/Subscriber) and Lab 2 (Services/Actions)"}),"\n",(0,i.jsx)(n.li,{children:"ROS 2 Humble Hawksbill installed"}),"\n",(0,i.jsx)(n.li,{children:"Basic knowledge of Python or C++"}),"\n",(0,i.jsx)(n.li,{children:"Understanding of ROS 2 communication patterns"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"lab-setup",children:"Lab Setup"}),"\n",(0,i.jsx)(n.p,{children:"Create a new ROS 2 package for this multi-node system:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Navigate to your workspace\ncd ~/ros2_labs/src\n\n# Create the multi-node lab package\nros2 pkg create --build-type ament_python ros2_lab3 --dependencies rclpy std_msgs geometry_msgs sensor_msgs action_msgs example_interfaces\n"})}),"\n",(0,i.jsx)(n.h2,{id:"system-architecture",children:"System Architecture"}),"\n",(0,i.jsx)(n.p,{children:"The multi-node system will consist of the following nodes:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Navigator Node"}),": Handles navigation tasks using action-based movement"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Perceptor Node"}),": Processes sensor data and detects objects"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Manipulator Node"}),": Controls robotic arm movements"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Coordinator Node"}),": Orchestrates the overall task execution"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Task Planner Node"}),": Plans sequences of actions based on goals"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"service-definition",children:"Service Definition"}),"\n",(0,i.jsxs)(n.p,{children:["First, let's create a custom service definition for object detection. Create ",(0,i.jsx)(n.code,{children:"ros2_lab3/srv/ObjectDetection.srv"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"string sensor_source\nfloat32 confidence_threshold\nstring[] object_classes\n---\nbool success\nstring message\nObject[] objects\nfloat32 detection_time\n\n# Nested message definition\nmsg Object:\n  string class\n  float32 confidence\n  float64[4] bbox  # x, y, width, height\n  float64[3] center_3d  # x, y, z\n"})}),"\n",(0,i.jsx)(n.h3,{id:"coordinator-node-implementation",children:"Coordinator Node Implementation"}),"\n",(0,i.jsxs)(n.p,{children:["Create the coordinator node in ",(0,i.jsx)(n.code,{children:"ros2_lab3/ros2_lab3/coordinator_node.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import rclpy\nfrom rclpy.node import Node\nfrom rclpy.action import ActionClient\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy\nfrom std_msgs.msg import String\nfrom geometry_msgs.msg import Pose\nfrom example_interfaces.action import Fibonacci\nfrom example_interfaces.srv import AddTwoInts  # Using example service for demonstration\n\n\nclass TaskCoordinator(Node):\n\n    def __init__(self):\n        super().__init__(\'task_coordinator\')\n\n        # Publishers for task status\n        self.status_publisher = self.create_publisher(String, \'task_status\', 10)\n\n        # Service client for object detection (using example service for this lab)\n        self.object_detection_client = self.create_client(\n            AddTwoInts, \'object_detection_service\')\n\n        # Action client for navigation\n        self.nav_action_client = ActionClient(\n            self, Fibonacci, \'navigate_to_location\')\n\n        # Timer for task orchestration\n        self.task_timer = self.create_timer(1.0, self.task_execution_callback)\n\n        self.current_task = "idle"\n        self.task_sequence = [\n            "navigate_to_object",\n            "detect_object",\n            "manipulate_object",\n            "return_to_base"\n        ]\n        self.task_index = 0\n\n    def task_execution_callback(self):\n        """Execute tasks in sequence"""\n        if self.current_task == "idle" and self.task_index < len(self.task_sequence):\n            task = self.task_sequence[self.task_index]\n            self.get_logger().info(f\'Executing task: {task}\')\n\n            if task == "navigate_to_object":\n                self.execute_navigation_task()\n            elif task == "detect_object":\n                self.execute_detection_task()\n            elif task == "manipulate_object":\n                self.execute_manipulation_task()\n            elif task == "return_to_base":\n                self.execute_return_task()\n\n            self.task_index += 1\n        elif self.task_index >= len(self.task_sequence):\n            self.get_logger().info(\'All tasks completed\')\n            self.current_task = "completed"\n            self.publish_status("completed")\n\n    def execute_navigation_task(self):\n        """Execute navigation task using action client"""\n        self.current_task = "navigating"\n        self.publish_status("navigating to object location")\n\n        # Send navigation goal\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = 5  # Simplified navigation goal\n\n        self.nav_action_client.wait_for_server()\n        future = self.nav_action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.navigation_feedback_callback)\n\n        future.add_done_callback(self.navigation_result_callback)\n\n    def navigation_feedback_callback(self, feedback_msg):\n        """Handle navigation feedback"""\n        self.get_logger().info(f\'Navigation progress: {feedback_msg.feedback.sequence}\')\n\n    def navigation_result_callback(self, future):\n        """Handle navigation result"""\n        goal_handle = future.result()\n        if goal_handle.accepted:\n            self.get_logger().info(\'Navigation goal accepted\')\n            result_future = goal_handle.get_result_async()\n            result_future.add_done_callback(self.navigation_complete_callback)\n\n    def navigation_complete_callback(self, future):\n        """Handle navigation completion"""\n        result = future.result().result\n        self.get_logger().info(f\'Navigation completed: {result.sequence}\')\n        self.current_task = "idle"\n        self.publish_status("navigation completed")\n\n    def execute_detection_task(self):\n        """Execute object detection task using service client"""\n        self.current_task = "detecting"\n        self.publish_status("detecting objects")\n\n        while not self.object_detection_client.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info(\'Object detection service not available, waiting...\')\n\n        # Using AddTwoInts service as an example - in a real system, you\'d use a custom object detection service\n        request = AddTwoInts.Request()\n        request.a = 10\n        request.b = 20\n\n        future = self.object_detection_client.call_async(request)\n        future.add_done_callback(self.detection_result_callback)\n\n    def detection_result_callback(self, future):\n        """Handle detection result"""\n        try:\n            response = future.result()\n            self.get_logger().info(f\'Detection result: {response.sum}\')\n            self.current_task = "idle"\n            self.publish_status("detection completed")\n        except Exception as e:\n            self.get_logger().error(f\'Service call failed: {e}\')\n            self.current_task = "idle"\n\n    def execute_manipulation_task(self):\n        """Execute manipulation task"""\n        self.current_task = "manipulating"\n        self.publish_status("manipulating object")\n        # In a real system, this would connect to a manipulation action server\n        # For this lab, we\'ll simulate the completion after a delay\n        self.create_timer(2.0, self.manipulation_complete_callback)\n\n    def manipulation_complete_callback(self):\n        """Handle manipulation completion"""\n        self.get_logger().info(\'Manipulation completed\')\n        self.current_task = "idle"\n        self.publish_status("manipulation completed")\n\n    def execute_return_task(self):\n        """Execute return to base task"""\n        self.current_task = "returning"\n        self.publish_status("returning to base")\n        # In a real system, this would connect to navigation action server\n        # For this lab, we\'ll simulate the completion after a delay\n        self.create_timer(2.0, self.return_complete_callback)\n\n    def return_complete_callback(self):\n        """Handle return completion"""\n        self.get_logger().info(\'Return to base completed\')\n        self.current_task = "idle"\n        self.publish_status("return completed")\n\n    def publish_status(self, status):\n        """Publish task status"""\n        msg = String()\n        msg.data = status\n        self.status_publisher.publish(msg)\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    coordinator = TaskCoordinator()\n\n    try:\n        rclpy.spin(coordinator)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        coordinator.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,i.jsx)(n.h3,{id:"navigator-node-implementation",children:"Navigator Node Implementation"}),"\n",(0,i.jsxs)(n.p,{children:["Create the navigator node in ",(0,i.jsx)(n.code,{children:"ros2_lab3/ros2_lab3/navigator_node.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom rclpy.action import ActionServer\nfrom example_interfaces.action import Fibonacci\nfrom geometry_msgs.msg import Twist\nfrom nav_msgs.msg import Odometry\n\n\nclass NavigatorNode(Node):\n\n    def __init__(self):\n        super().__init__('navigator_node')\n\n        # Action server for navigation\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            'navigate_to_location',\n            self.execute_navigation_callback)\n\n        # Publisher for movement commands\n        self.cmd_vel_publisher = self.create_publisher(Twist, 'cmd_vel', 10)\n\n        # Subscriber for odometry\n        self.odom_subscriber = self.create_subscription(\n            Odometry, 'odom', self.odom_callback, 10)\n\n        self.current_pose = None\n        self.get_logger().info('Navigator node initialized')\n\n    def odom_callback(self, msg):\n        \"\"\"Update current pose from odometry\"\"\"\n        self.current_pose = msg.pose.pose\n\n    def execute_navigation_callback(self, goal_handle):\n        \"\"\"Execute navigation action\"\"\"\n        self.get_logger().info('Executing navigation goal...')\n\n        # Create feedback and result messages\n        feedback_msg = Fibonacci.Feedback()\n        result_msg = Fibonacci.Result()\n\n        # Simulate navigation by sending movement commands\n        twist_msg = Twist()\n        twist_msg.linear.x = 0.5  # Move forward at 0.5 m/s\n        twist_msg.angular.z = 0.0  # No rotation\n\n        # Send movement commands for the duration of the goal\n        for i in range(goal_handle.request.order):\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Navigation goal canceled')\n                result_msg.sequence = feedback_msg.sequence\n                return result_msg\n\n            # Publish movement command\n            self.cmd_vel_publisher.publish(twist_msg)\n\n            # Update feedback\n            feedback_msg.sequence.append(i)\n            goal_handle.publish_feedback(feedback_msg)\n\n            # Sleep to simulate movement\n            self.get_clock().sleep_for(rclpy.duration.Duration(seconds=1.0))\n\n        # Stop the robot\n        twist_msg.linear.x = 0.0\n        self.cmd_vel_publisher.publish(twist_msg)\n\n        # Complete the goal\n        goal_handle.succeed()\n        result_msg.sequence = feedback_msg.sequence\n        self.get_logger().info(f'Navigation completed: {result_msg.sequence}')\n\n        return result_msg\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    navigator = NavigatorNode()\n\n    try:\n        rclpy.spin(navigator)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        navigator.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"perceptor-node-implementation",children:"Perceptor Node Implementation"}),"\n",(0,i.jsxs)(n.p,{children:["Create the perceptor node in ",(0,i.jsx)(n.code,{children:"ros2_lab3/ros2_lab3/perceptor_node.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Image, LaserScan\nfrom std_msgs.msg import String\nfrom example_interfaces.srv import AddTwoInts  # Using example service for demonstration\n\n\nclass PerceptorNode(Node):\n\n    def __init__(self):\n        super().__init__('perceptor_node')\n\n        # Publishers for detected objects\n        self.object_publisher = self.create_publisher(String, 'detected_objects', 10)\n\n        # Subscribers for sensor data\n        self.image_subscriber = self.create_subscription(\n            Image, 'camera/image_raw', self.image_callback, 10)\n\n        self.laser_subscriber = self.create_subscription(\n            LaserScan, 'scan', self.laser_callback, 10)\n\n        # Service server for object detection requests\n        self.detection_service = self.create_service(\n            AddTwoInts, 'object_detection_service', self.detection_service_callback)\n\n        self.get_logger().info('Perceptor node initialized')\n\n    def image_callback(self, msg):\n        \"\"\"Process image data and detect objects\"\"\"\n        # Simulate object detection from image\n        # In a real system, this would use computer vision algorithms\n        if len(msg.data) > 0:  # If image has data\n            # Simulate detection of an object\n            detected_obj_msg = String()\n            detected_obj_msg.data = f\"object_detected_at_{self.get_clock().now().nanoseconds}\"\n            self.object_publisher.publish(detected_obj_msg)\n            self.get_logger().info(f'Detected object: {detected_obj_msg.data}')\n\n    def laser_callback(self, msg):\n        \"\"\"Process laser scan data for obstacle detection\"\"\"\n        # Simulate obstacle detection from laser scan\n        if len(msg.ranges) > 0:\n            min_range = min(msg.ranges)\n            if min_range < 1.0:  # If obstacle is within 1 meter\n                self.get_logger().info(f'Obstacle detected at {min_range:.2f}m')\n\n    def detection_service_callback(self, request, response):\n        \"\"\"Handle object detection service requests\"\"\"\n        self.get_logger().info(f'Detection service called with: {request.a}, {request.b}')\n\n        # Simulate detection process\n        # In a real system, this would process sensor data and detect objects\n        response.sum = request.a + request.b  # Simple sum for demonstration\n\n        self.get_logger().info(f'Detection service returning: {response.sum}')\n        return response\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    perceptor = PerceptorNode()\n\n    try:\n        rclpy.spin(perceptor)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        perceptor.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"setup-for-execution",children:"Setup for Execution"}),"\n",(0,i.jsxs)(n.p,{children:["Update the ",(0,i.jsx)(n.code,{children:"setup.py"})," file to make the nodes executable:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from setuptools import find_packages, setup\n\npackage_name = 'ros2_lab3'\n\nsetup(\n    name=package_name,\n    version='0.0.0',\n    packages=find_packages(exclude=['test']),\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n            ['resource/' + package_name]),\n        ('share/' + package_name, ['package.xml']),\n    ],\n    install_requires=['setuptools'],\n    zip_safe=True,\n    maintainer='your_name',\n    maintainer_email='your_email@example.com',\n    description='ROS 2 multi-node system integration lab',\n    license='Apache-2.0',\n    tests_require=['pytest'],\n    entry_points={\n        'console_scripts': [\n            'coordinator = ros2_lab3.coordinator_node:main',\n            'navigator = ros2_lab3.navigator_node:main',\n            'perceptor = ros2_lab3.perceptor_node:main',\n        ],\n    },\n)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"running-the-multi-node-system",children:"Running the Multi-Node System"}),"\n",(0,i.jsx)(n.h3,{id:"1-build-the-package",children:"1. Build the Package"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Navigate to your workspace\ncd ~/ros2_labs\n\n# Build the package\ncolcon build --packages-select ros2_lab3\n\n# Source the workspace\nsource install/setup.bash\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-run-the-nodes",children:"2. Run the Nodes"}),"\n",(0,i.jsx)(n.p,{children:"Run each node in a separate terminal:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Terminal 1 - Perceptor Node:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run ros2_lab3 perceptor\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Terminal 2 - Navigator Node:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run ros2_lab3 navigator\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Terminal 3 - Coordinator Node:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run ros2_lab3 coordinator\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-monitor-the-system",children:"3. Monitor the System"}),"\n",(0,i.jsx)(n.p,{children:"Monitor the communication between nodes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# List all active topics\nros2 topic list\n\n# Monitor task status\nros2 topic echo /task_status std_msgs/msg/String\n\n# Monitor detected objects\nros2 topic echo /detected_objects std_msgs/msg/String\n\n# Monitor navigation feedback\nros2 action list\nros2 action info /navigate_to_location\n"})}),"\n",(0,i.jsx)(n.h2,{id:"multi-node-communication-patterns",children:"Multi-Node Communication Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"publisher-subscriber-pattern-across-nodes",children:"Publisher-Subscriber Pattern Across Nodes"}),"\n",(0,i.jsx)(n.p,{children:"The perceptor node publishes detected objects that can be subscribed to by other nodes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Example of another node subscribing to detected objects\nclass SubscriberNode(Node):\n    def __init__(self):\n        super().__init__('subscriber_node')\n        self.subscription = self.create_subscription(\n            String, 'detected_objects', self.object_callback, 10)\n\n    def object_callback(self, msg):\n        self.get_logger().info(f'Received detected object: {msg.data}')\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-based-communication",children:"Service-Based Communication"}),"\n",(0,i.jsx)(n.p,{children:"Nodes can communicate through services for synchronous requests:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Example service client in another node\nclass ServiceClientNode(Node):\n    def __init__(self):\n        super().__init__('service_client_node')\n        self.cli = self.create_client(AddTwoInts, 'object_detection_service')\n\n    def call_detection_service(self, a, b):\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting...')\n\n        request = AddTwoInts.Request()\n        request.a = a\n        request.b = b\n        future = self.cli.call_async(request)\n        return future\n"})}),"\n",(0,i.jsx)(n.h3,{id:"action-based-communication",children:"Action-Based Communication"}),"\n",(0,i.jsx)(n.p,{children:"For long-running tasks, nodes use actions:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Example action client in another node\nclass ActionClientNode(Node):\n    def __init__(self):\n        super().__init__('action_client_node')\n        self._action_client = ActionClient(self, Fibonacci, 'navigate_to_location')\n\n    def send_navigation_goal(self, order):\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = order\n\n        self._action_client.wait_for_server()\n        send_goal_future = self._action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback)\n\n        send_goal_future.add_done_callback(self.goal_response_callback)\n        return send_goal_future\n"})}),"\n",(0,i.jsx)(n.h2,{id:"lab-exercises",children:"Lab Exercises"}),"\n",(0,i.jsx)(n.h3,{id:"exercise-1-add-error-handling",children:"Exercise 1: Add Error Handling"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Implement error handling in the coordinator node when services or actions are not available"}),"\n",(0,i.jsx)(n.li,{children:"Add retry logic for failed communications"}),"\n",(0,i.jsx)(n.li,{children:"Implement graceful degradation when nodes fail"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"exercise-2-extend-the-system",children:"Exercise 2: Extend the System"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Add a new node for battery monitoring that publishes battery status"}),"\n",(0,i.jsx)(n.li,{children:"Modify the coordinator to check battery status before executing tasks"}),"\n",(0,i.jsx)(n.li,{children:"Implement task prioritization based on battery level"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"exercise-3-add-logging-and-diagnostics",children:"Exercise 3: Add Logging and Diagnostics"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Add comprehensive logging to track system state"}),"\n",(0,i.jsx)(n.li,{children:"Implement a diagnostics node that monitors all other nodes"}),"\n",(0,i.jsx)(n.li,{children:"Create a dashboard that visualizes the system status"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"exercise-4-performance-optimization",children:"Exercise 4: Performance Optimization"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Analyze communication patterns and identify bottlenecks"}),"\n",(0,i.jsx)(n.li,{children:"Optimize message frequency and QoS settings"}),"\n",(0,i.jsx)(n.li,{children:"Implement message compression for large data (images, point clouds)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"debugging-multi-node-systems",children:"Debugging Multi-Node Systems"}),"\n",(0,i.jsx)(n.h3,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Node Discovery Issues"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Check that all nodes are on the same ROS domain"}),"\n",(0,i.jsx)(n.li,{children:"Verify that the ROS_MASTER_URI is properly set"}),"\n",(0,i.jsx)(n.li,{children:"Ensure network configuration allows node discovery"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Communication Delays"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Check QoS settings for appropriate reliability"}),"\n",(0,i.jsx)(n.li,{children:"Verify network bandwidth for high-frequency topics"}),"\n",(0,i.jsx)(n.li,{children:"Consider using intra-process communication where possible"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Resource Conflicts"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure nodes have unique names"}),"\n",(0,i.jsx)(n.li,{children:"Check for topic name collisions"}),"\n",(0,i.jsx)(n.li,{children:"Verify action and service names are unique"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"debugging-commands",children:"Debugging Commands"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check node connectivity\nros2 run demo_nodes_cpp talker &\nros2 run demo_nodes_py listener\n\n# Monitor system resources\nros2 run top ros2_top\n\n# Check message statistics\nros2 topic hz /topic_name\n\n# Monitor system status\nros2 doctor\n"})}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:"In this lab, you've implemented a complex multi-node ROS 2 system that demonstrates:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"System Architecture"}),": Designing multiple nodes with specific responsibilities"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Communication Patterns"}),": Using topics, services, and actions for inter-node communication"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Task Coordination"}),": Orchestrating complex behaviors across multiple nodes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Error Handling"}),": Implementing robust error handling in distributed systems"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"System Integration"}),": Combining different ROS 2 concepts into a cohesive system"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This multi-node approach is essential for real-world robotic systems where different components need to work together to achieve complex goals. The coordinator pattern demonstrated here is commonly used in robotics for task planning and execution management."})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>a,x:()=>r});var t=s(6540);const i={},o=t.createContext(i);function a(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);